<!DOCTYPE html>
<html>
<head>
	<title>Canvas implementation</title>
	<script type="text/javascript" src="scripts/utils.js"></script>
	<style type="text/css">
		body{
			width: 600px;
			margin: 0 auto;
		}
		canvas#cav{
			border: 1px solid;
		}
	</style>
</head>
<body>
<canvas id="cav" width="600" height="800">Your browser doens not support canvas!</canvas>
<script type="text/javascript">
	var canvas=document.getElementById('cav'),
		 ctx=canvas.getContext('2d'),
		 width=canvas.width, height=canvas.height,
		 x = 0, y= 0, 
		 blockWidth = 20, blockHeight = 20, 
		 dir=5,
		 baseRow = 0, baseColumn = width/blockWidth/2, 
		 rowCount=0, columnCount=0,
		 grid=[], objGrid=[];

	function DisplayGrid(){
		var initX = 0, initY=0;
		for(var r=0; r<width/blockWidth; r++){
			grid[r] = [];
			for(var c=0; c<height/blockHeight; c++){
				grid[r][c] = {x:c*blockHeight, y:r*blockWidth, status: 0};
			}
		}		
		this.draw=function(){		
		ctx.strokeStyle = "#AAA";			
			while(initX<width){				
				initX = initX+blockWidth;				
				ctx.beginPath();		
				ctx.moveTo(initX,0);				
				ctx.lineTo(initX,height);					
				ctx.stroke();					
			}
			while(initY<height){
				initY = initY+blockHeight;
				ctx.beginPath();		
				ctx.moveTo(0,initY);				
				ctx.lineTo(width,initY);					
				ctx.stroke();	
			}
					

		}
	}

	function Brick(rows, cols, status){
		var bricks = [];
		var initR = baseRow, initC = baseColumn;		
		for(var r=0; r<rows; r++){	
			bricks[r] = [];
			initC = baseColumn;
			for(var c=0; c<cols; c++){
				bricks[r][c] = {x:initC*blockWidth, y:r*blockHeight, status:status[r][c], girdX:r, gridY: baseColumn+c};
				initC++;
			}
			initR++;
		}
		console.log(bricks);
				
		this.draw = function(){			
			for(var r in bricks){
				for(var c in bricks[r]){
					if(bricks[r][c].status != 0){
						ctx.beginPath();
						ctx.moveTo(bricks[r][c].x,bricks[r][c].y);
						ctx.fillStyle = "#ff0000";
						ctx.fillRect(bricks[r][c].x,bricks[r][c].y,blockWidth,blockHeight);
						ctx.strokeStyle = "#555555"								;
						ctx.strokeRect(bricks[r][c].x,bricks[r][c].y,blockWidth,blockHeight);
					}
				}
			}			
		}

		this.logic = function(){
			var floorOfTheObject = bricks.reduce(function(prev, current){
				return(prev.gridX>current.gridX)? prev:current;
			})
			console.log(floorOfTheObject);
		}
	}

	function IBrick(){					
		rowCount = 4;
		columnCount = 1;
		var statusObj = [[1],[1],[1],[1]]
		var iBrick = new Brick(rowCount, columnCount, statusObj);
		return iBrick;
	}

	function TBrick(){
		rowCount = 2;
		columnCount = 3;
		var statusObj = [[0,1,0],[1,1,1]];
		return new Brick(rowCount, columnCount, statusObj);
	}

	function RBrick(){
		rowCount = 2;
		columnCount = 2;
		var statusObj = [[1,1],[1,1]];
		return new Brick(rowCount, columnCount, statusObj);
	}

	function ZBrick(){
		rowCount = 2;
		columnCount = 3;
		var statusObj = [[1,1,0],[0,1,1]];
		return new Brick(rowCount, columnCount, statusObj);
	}

	function LBrick(){
		rowCount = 3;
		columnCount = 2;
		var statusObj = [[1,1],[1,0],[1,0]];
		return new Brick(rowCount, columnCount, statusObj);
	}




	// var ball1=new Ball();
	// var ball2=new Ball();
	// var ball3=new Ball();

	// var balls=[new Ball(),new Ball(),new Ball()];
	var disp = new DisplayGrid();
	disp.draw();
	var obj = [new LBrick()];

	// setInterval(function(){
	// 	ctx.clearRect(0,0,width,height);		
		obj.forEach(function(item){
			item.logic();
			item.draw();
		});
	// },30);
	document.onkeydown = move;
	


</script>
</body>
</html>